/* Reader styles with CSS variables and theme support */

:root {
  color-scheme: light dark;
  /* Base variables (overridden by themes) */
  --font-family: 'Cormorant Garamond', Georgia, 'Times New Roman', serif;
  --heading-font-family: 'Cormorant Garamond', system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  --font-size: clamp(18px, 2.2vw, 24px);
  --line-height: 1.5;
  --text-width: 70ch;
  --page-padding-block: 2rem;
  --page-padding-inline: 1rem;
  --paragraph-spacing: 1rem;
  --paragraph-indent: 2em;
  --background: #ffffff;
  --foreground: #111111;
  --quote-color: #4444aa;
  --italics-color: inherit;
  --p-num-color: #666666;
}

/* Default theme (modern) */
html[data-theme="default"] {
  --font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, 'Helvetica Neue', Arial, sans-serif;
  --heading-font-family: 'Cormorant Garamond', system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  --font-size: clamp(17px, 2.1vw, 22px);
  --line-height: 1.5;
  --text-width: 68ch;
  --background: #ffffff;
  --foreground: #111111;
  --quote-color: #1d4ed8;
  --italics-color: #0f766e;
  --p-num-color: #6b7280;
}

/* Classic theme (book-like) */
html[data-theme="classic"] {
  --font-family: 'Cormorant Garamond', Georgia, 'Times New Roman', serif;
  --heading-font-family: 'Cormorant Garamond', Georgia, 'Times New Roman', serif;
  --font-size: clamp(24px, 2.2vw, 24px);
  --line-height: 1.5;
  --text-width: 70ch;
  --background: #dbd4c2;
  --foreground: #14110f;
  --quote-color: #220c93;
  --italics-color: #860505;
  --p-num-color: #726e68;
}

/* Dark preference tweaks */
@media (prefers-color-scheme: dark) {
  html[data-theme="default"], html:not([data-theme]) {
    --background: #0b1220; /* dark blue for lower contrast */
    --foreground: #b1d7fb;
    --font-size: clamp(19px, 2.31vw, 24px); /* ~10% larger for dark mode */
    --quote-color: #76b2f7;
    --italics-color: #99f6e4;
    --p-num-color: #909090;
  }
  html[data-theme="classic"] {
    --background: #0b1220; /* dark blue for lower contrast */
    --foreground: #85b7e6;
    --font-size: clamp(26px, 2.42vw, 26px); /* ~10% larger for dark mode */
    --quote-color: #949cf7;
    --italics-color: #8e3dc5;
    --p-num-color: #3b57a9;
  }
}

html, body { margin: 0; padding: 0; }

body {
  font-family: var(--font-family);
  font-weight: 400;
  line-height: var(--line-height);
  font-size: var(--font-size);
  background: var(--background);
  color: var(--foreground);
}

main {
  max-width: var(--text-width);
  margin: 0 auto;
  padding: var(--page-padding-block) var(--page-padding-inline) calc(var(--page-padding-block) * 2);
}

h1, h2, h3 {
  font-family: var(--heading-font-family);
  font-weight: 500;
  line-height: 1.25;
  margin: 2rem 0 1rem;
}

/* Chapter headers (level 1) 30% smaller than typical default (~2em -> ~1.4em) */
h1 { font-size: 1.4em; }

p { text-align: justify; }

/* Paragraph mode: margin (default) */
p { margin: 0 0 var(--paragraph-spacing); text-indent: 0; }

/* Paragraph mode: indent */
html[data-para="indent"] p { text-indent: var(--paragraph-indent); margin: 0 0 var(--paragraph-spacing); }

nav.toc { margin: 1rem 0 2rem; }

nav.toc ul { list-style: none; padding: 0; }

nav.toc li { margin: 0.25rem 0; }

/* Quote and italics */
q { color: var(--quote-color); }
i, em { color: var(--italics-color); font-style: italic; }

/* Footnotes */
.fn-ref { text-decoration: none; vertical-align: super; font-size: 0.8em; padding-left: 2px; }
.fn-marker { font-weight: 600; }
.fn-back { text-decoration: none; margin-left: 6px; }

/* Small control bar */
/* Controls removed */

/* Responsive adjustments */
@media (max-width: 640px) {
  :root { --text-width: 92vw; --page-padding-inline: 1rem; }
  /* Line height 30% above font-size only on smartphones */
  html { --line-height: 1.3; }
}
@media (min-width: 641px) and (max-width: 1024px) {
  :root { --text-width: 80ch; --page-padding-inline: 1.25rem; }
}
@media (min-width: 1025px) {
  :root { --text-width: 72ch; }
}

/* Paragraph numbering */
.p-num {
  color: var(--p-num-color);
  text-decoration: none;
  padding-right: 0.5ch;
  font-size: 0.7em;
}

/* Chapter navigation */
.chapter-nav {
  display: flex;
  justify-content: space-between;
  gap: 1rem;
  margin: 2rem 0 0;
}
.nav-btn {
  display: inline-block;
  text-decoration: none;
  padding: 0.5rem 0.9rem;
  border-radius: 6px;
  border: 1px solid rgba(0,0,0,0.15);
  background: rgba(0,0,0,0.03);
  color: var(--foreground);
}
.nav-btn:hover { background: rgba(0,0,0,0.06); }
@media (prefers-color-scheme: dark) {
  .nav-btn {
    border-color: rgba(255,255,255,0.2);
    background: rgba(255,255,255,0.06);
  }
  .nav-btn:hover { background: rgba(255,255,255,0.1); }
}

/* Dark mode smartphone: make body text light grey */
@media (max-width: 640px) and (prefers-color-scheme: dark) {
  body { color: var(--foreground); }
}

